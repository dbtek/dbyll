I"L¥<p><br /><br /></p>

<h1 id="í˜ì´ì§€-ì²˜ë¦¬ë˜ëŠ”-ì˜í™”ë³„-í‰ê· -ì ìˆ˜ë¦¬ë·°-ê°œìˆ˜-êµ¬í•˜ê¸°"><center>í˜ì´ì§€ ì²˜ë¦¬ë˜ëŠ” ì˜í™”ë³„ í‰ê·  ì ìˆ˜/ë¦¬ë·° ê°œìˆ˜ êµ¬í•˜ê¸°</center></h1>

<p><br /></p>

<p><em>í•´ë‹¹ ë‚´ìš©ì€ ì±… â€˜ì½”ë“œë¡œ ë°°ìš°ëŠ” ìŠ¤í”„ë§ë¶€íŠ¸ ì›¹ í”„ë¡œì íŠ¸â€™ì˜ ë‚´ìš©ì´ë©° ì´ ê²Œì‹œë¬¼ì€ ê·¸ ì±…ì„ ê°œì¸ì ìœ¼ë¡œ ê³µë¶€í•˜ë©° ë©”ëª¨í•´ ë‘ê¸° ìœ„í•´ì„œ ì“°ëŠ” ê²ƒì„ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤</em></p>

<p><br /><br /></p>

<p>ì´ë²ˆ ë°©ëª…ë¡ ë§Œë“¤ê¸° í”„ë¡œì íŠ¸ë¥¼ í†µí•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ í•™ìŠµí•œë‹¤.</p>

<ul>
  <li>í”„ë¡œì íŠ¸ì˜ ê³„ì¸µë³„ êµ¬ì¡°ì™€ ê°ì²´ë“¤ì˜ êµ¬ì„±</li>
  <li>Querydslì„ ì´ìš©í•´ì„œ ë™ì ìœ¼ë¡œ ê²€ìƒ‰ ì¡°ê±´ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•</li>
  <li>Entity ê°ì²´ì™€ DTOì˜ êµ¬ë¶„</li>
  <li>í™”ë©´ì—ì„œì˜ í˜ì´ì§• ì²˜ë¦¬</li>
</ul>

<p><br /></p>

<p>ì›¹ í”„ë¡œì íŠ¸ë¥¼ êµ¬ì„±í•  ë•ŒëŠ” ê°€ì¥ ë¨¼ì € ì™€ì´ì–´í”„ë ˆì„(í™”ë©´ ì„¤ê³„ì„œ)ì„ ì œì‘í•˜ê³  ì§„í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì™€ì´ì–´í”„ë ˆì„ì„ ì œì‘í•˜ë©´ í™”ë©´ì˜ URIì™€ ì „ë‹¬ë˜ëŠ” íŒŒë¼ë¯¸í„° ë“±ì„ ë¯¸ë¦¬ ê²°ì •í•  ìˆ˜ ìˆê³  ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì— í•„ìš”í•œ ì¹¼ëŸ¼ë“¤ì„ ë¯¸ë¦¬ íŒŒì•…í•˜ëŠ”ë°ë„ ë„ì›€ì´ ëœë‹¤.</p>

<p><strong>í™”ë©´ ê°œë°œì˜ ëª©í‘œ</strong></p>

<ul>
  <li>ëª©ë¡ í™”ë©´ (ë²ˆí˜¸ 1) - ì „ì²´ ëª©ë¡ì„ í˜ì´ì§• ì²˜ë¦¬í•´ì„œ ì¡°íšŒí•  ìˆ˜ ìˆê³ , ì œëª©/ë‚´ìš©/ì‘ì„±ì í•­ëª©ìœ¼ë¡œ ê²€ìƒ‰ê³¼ í˜ì´ì§• ì²˜ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.</li>
  <li>ë“±ë¡ í™”ë©´(ë²ˆí˜¸ 2) - ìƒˆë¡œìš´ ê¸€ì„ ë“±ë¡í•  ìˆ˜ ìˆê³ , ë“±ë¡ ì²˜ë¦¬ í›„ ë‹¤ì‹œ ëª©ë¡ í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ê²Œ ëœë‹¤.</li>
  <li>ì¡°íšŒ í™”ë©´(ë²ˆí˜¸ 3) - ëª©ë¡ í™”ë©´ì—ì„œ íŠ¹ì •í•œ ê¸€ì„ ì„ íƒí•˜ë©´ ìë™ìœ¼ë¡œ ì¡°íšŒ í™”ë©´ìœ¼ë¡œ ì´ë™í•œë‹¤. ì¡°íšŒ í™”ë©´ì—ì„œëŠ” ìˆ˜ì •/ì‚­ì œê°€ ê°€ëŠ¥í•œ í™”ë©´(ë²ˆí˜¸ 4)ìœ¼ë¡œ ë²„íŠ¼ì„ í´ë¦­í•´ì„œ ì´ë™í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ìˆ˜ì •/ì‚­ì œ í™”ë©´(ë²ˆí˜¸ 4) - ìˆ˜ì • í™”ë©´ì—ì„œ ì‚­ì œê°€ ê°€ëŠ¥í•˜ê³  ì‚­ì œ í›„ì—ëŠ” ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤. ê¸€ì„ ìˆ˜ì •í•˜ëŠ” ê²½ìš°ì—ëŠ” ë‹¤ì‹œ ì¡°íšŒ í™”ë©´(ë²ˆí˜¸ 2)ìœ¼ë¡œ ì´ë™í•´ì„œ ìˆ˜ì •ëœ ë‚´ìš©ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</li>
</ul>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-06-40.png" alt="" /></p>

<p><br /></p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-16-17.png" alt="" /></p>

<p><br /></p>

<p>í”„ë¡œì íŠ¸ì˜ ê¸°ë³¸ êµ¬ì¡°ëŠ” ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-16-47.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>ë¸Œë¼ìš°ì €ì—ì„œ ë“¤ì–´ì˜¤ëŠ” RequestëŠ” GuestbookControllerë¼ëŠ” ê°ì²´ë¡œ ì²˜ë¦¬í•œë‹¤.</li>
  <li>GuestbookControllerëŠ” GuestbookService íƒ€ì…ì„ ì£¼ì…ë°›ëŠ” êµ¬ì¡°ë¡œ ë§Œë“¤ê³ , ì´ë¥¼ ì´ìš©í•´ì„œ ì›í•˜ëŠ” ì‘ì—…ì„ ì²˜ë¦¬í•œë‹¤.</li>
  <li>GuestbookRepositoryëŠ” Spring Data JPAë¥¼ ì´ìš©í•´ì„œ êµ¬ì„±í•˜ê³ , GuestbookServiceImpl í´ë˜ìŠ¤ì— ì£¼ì…í•´ì„œ ì‚¬ìš©í•œë‹¤.</li>
  <li>ë§ˆì§€ë§‰ ê²°ê³¼ëŠ” Thymeleafë¥¼ ì´ìš©í•´ì„œ ë ˆì´ì•„ì›ƒ í…œí”Œë¦¿ì„ í™œìš©í•´ì„œ ì²˜ë¦¬í•œë‹¤.</li>
</ul>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-21-10.png" alt="" /></p>

<p><br /></p>

<ul>
  <li>ë¸Œë¼ìš°ì €ì—ì„œ ì „ë‹¬ë˜ëŠ” ReqeustëŠ” GuestbookControllerì—ì„œ DTOì˜ í˜•íƒœë¡œ ì²˜ë¦¬ëœë‹¤.</li>
  <li>GuestbookRepositoryëŠ” ì—”í‹°í‹° íƒ€ì…ì„ ì´ìš©í•˜ë¯€ë¡œ ì¤‘ê°„ì— Service ê³„ì¸µì—ì„œëŠ” DTOì™€ ì—”í‹°í‹°ì˜ ë³€í™˜ì„ ì²˜ë¦¬í•œë‹¤.</li>
</ul>

<p>ì ì´ì œ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•´ ë³´ì.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-23-19.png" alt="" /></p>

<p><br /></p>

<p>ì˜ì¡´ì„±ìœ¼ë¡œëŠ”</p>

<ul>
  <li>Spring Boot DevTools</li>
  <li>Lombok</li>
  <li>Spring Web</li>
  <li>Thymeleaf</li>
  <li>Spring Data JPA</li>
</ul>

<p>ë¥¼ ì²´í¬í•œë‹¤.</p>

<p><img src="../images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-23-58.png" alt="" /></p>

<p><br /></p>

<p>ì´ì œ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ë“œë¼ì´ë²„ ì¶”ê°€ë¥¼ í•  ì°¨ë¡€ì´ë‹¤. ì±…ì—ì„œëŠ” MariaDBê´€ë ¨ JDBC ë“œë¼ì´ë²„ë¥¼ ì¶”ê°€í–ˆì§€ë§Œ ë‚˜ëŠ” MySql ê´€ë ¨ JDBC ë“œë¼ì´ë²„ë¥¼ ì¶”ê°€í•œë‹¤. ê·¸ë¦¬ê³  Thymeleafì—ì„œ ì‚¬ìš©í•˜ê²Œ ë  java8 ë‚ ì§œ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ì¶”ê°€í•œë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-30-27.png" alt="" /></p>

<p><br /></p>

<p><strong>build.gradle</strong></p>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>    <span class="n">compile</span> <span class="nl">group:</span> <span class="s1">'org.thymeleaf.extras'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'thymeleaf-extras-java8time'</span>
    <span class="n">compile</span> <span class="nl">group:</span> <span class="s1">'mysql'</span><span class="o">,</span> <span class="nl">name:</span> <span class="s1">'mysql-connector-java'</span><span class="o">,</span> <span class="nl">version:</span> <span class="s1">'8.0.22'</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ê·¸ë¦¬ê³  ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ì„¤ì •ë„ ì¶”ê°€í•œë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-30-49.png" alt="" /></p>

<p><br /></p>

<p><strong>application.properties</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.datasource.url=jdbc:mysql://localhost:3306/bootex?serverTimezone=UTC&amp;characterEncoding=UTF-8
spring.datasource.username=bootex
spring.datasource.password=bootex

spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.show-sql=true

spring.thymeleaf.cache=false

</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ì»¨íŠ¸ë¡¤ëŸ¬/í™”ë©´ ê´€ë ¨ ì¤€ë¹„ëŠ” ì´ì „ ì¥ì—ì„œ ì‘ì„±í•´ ë‘” layout í´ë”ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-32-56.png" alt="" /></p>

<p><br /></p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-33-03.png" alt="" /></p>

<p><br /></p>

<p><strong>GuestbookController.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.techlead.guestbook.controller</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.extern.log4j.Log4j2</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>


<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/guestbook"</span><span class="o">)</span>
<span class="nd">@Log4j2</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GuestbookController</span> <span class="o">{</span>
    <span class="nd">@GetMapping</span><span class="o">({</span><span class="s">"/"</span><span class="o">,</span><span class="s">"/list"</span><span class="o">})</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">index</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"list......"</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">"/guestbook/list"</span><span class="o">;</span>
    <span class="o">}</span>


<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<blockquote>
  <h4 id="line-16-ë¦¬í„´ìœ¼ë¡œ-htmlì˜-ê²½ë¡œë¥¼-ë°˜í™˜í•˜ê³ -ìˆë‹¤-ì¦‰-templateguestbook-ì•„ë˜ì—-ìˆëŠ”-listhtmlë¥¼-ë³´ì—¬ì¤„-ê²ƒì´ë‹¤-ë§Œì•½-ë¬¸ìì—´ì„-ë°˜í™˜í•˜ì§€-ì•ŠëŠ”ë‹¤ë©´-getmapping-ì–´ë…¸í…Œì´ì…˜ì˜-ë””í´íŠ¸-ê¸°ëŠ¥ìœ¼ë¡œì„œ-ê·¸-ì–´ë…¸í…Œì´ì…˜-ì•ˆì—-ë¬¸ìì—´ì—-í•´ë‹¹í•˜ëŠ”-htmlì´-ìˆëŠ”ì§€-ì°¾ê³ -ìˆìœ¼ë©´-ì €ì ˆë¡œ-ë§¤í•‘í•´ì¤„-ê²ƒì´ë‹¤"><strong>line 16:</strong> ë¦¬í„´ìœ¼ë¡œ htmlì˜ ê²½ë¡œë¥¼ ë°˜í™˜í•˜ê³  ìˆë‹¤ ì¦‰ template/guestbook ì•„ë˜ì— ìˆëŠ” list.htmlë¥¼ ë³´ì—¬ì¤„ ê²ƒì´ë‹¤. ë§Œì•½ ë¬¸ìì—´ì„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ @GetMapping ì–´ë…¸í…Œì´ì…˜ì˜ ë””í´íŠ¸ ê¸°ëŠ¥ìœ¼ë¡œì„œ ê·¸ ì–´ë…¸í…Œì´ì…˜ ì•ˆì— ë¬¸ìì—´ì— í•´ë‹¹í•˜ëŠ” htmlì´ ìˆëŠ”ì§€ ì°¾ê³  ìˆìœ¼ë©´ ì €ì ˆë¡œ ë§¤í•‘í•´ì¤„ ê²ƒì´ë‹¤.<br /></h4>
</blockquote>

<p>ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ ë³´ê¸° ìœ„í•´ ì¼ë‹¨ list.htmlì€ layout í´ë”ì˜ basic.htmlì„ ì´ìš©í•˜ëŠ” êµ¬ì¡°ë¡œ ì‘ì„±í•˜ê³  ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” ë‚´ìš©ìœ¼ë¡œ ì‘ì„±í•œë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-38-23.png" alt="" /></p>

<p><br /></p>

<p><strong>list.html</strong></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span> <span class="na">xmlns:th=</span><span class="s">"http://www.thymeleaf.org"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;th:block</span> <span class="na">th:replace=</span><span class="s">"~{/layout/basic :: setContent(~{this::content} )}"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;th:block</span> <span class="na">th:fragment=</span><span class="s">"content"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>Guestbook List Page<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;/th:block&gt;</span>
  <span class="nt">&lt;/th:block&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<blockquote>
  <h4 id="line-4-layoutì•„ë˜-basichtmlì—-fragmentë¡œ-ì„ ì–¸ë˜ì–´-ìˆëŠ”-ê²ƒ-ì¤‘-ì´ë¦„ì´-setcontentì¸-ë¶€ë¶„ìœ¼ë¡œ-replaceí•œë‹¤-ê·¸ë¦¬ê³ -thiscontentë¥¼-íŒŒë¼ë¯¸í„°ë¡œ-ë„˜ê²¨ì£¼ê³ -ìˆë‹¤-ì¦‰-listhtml-ì•ˆì—-fragment-ì´ë¦„ì´-contentì¸-ë¶€ë¶„ì„-ë„˜ê²¨ì¤€ë‹¤-basichtmlì€-ì–´ë–¤-í‹€ë§ˆëƒ¥-í…œí”Œë¦¿ì²˜ëŸ¼-ì‘ìš©í•˜ê³ -ê·¸-í‹€-ì•ˆì˜-ë‚´ìš©ì„-listhtmlì˜-contentë¶€ë¶„ìœ¼ë¡œ-ì±„ìš´ë‹¤ê³ -ìƒê°í•˜ë©´-ì‰½ë‹¤"><strong>line 4:</strong> /layoutì•„ë˜ basic.htmlì— fragmentë¡œ ì„ ì–¸ë˜ì–´ ìˆëŠ” ê²ƒ ì¤‘ ì´ë¦„ì´ â€œsetContent()â€ì¸ ë¶€ë¶„ìœ¼ë¡œ replaceí•œë‹¤. ê·¸ë¦¬ê³  this::contentë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì£¼ê³  ìˆë‹¤. ì¦‰ list.html ì•ˆì— fragment ì´ë¦„ì´ â€œcontentâ€ì¸ ë¶€ë¶„ì„ ë„˜ê²¨ì¤€ë‹¤. basic.htmlì€ ì–´ë–¤ í‹€ë§ˆëƒ¥ í…œí”Œë¦¿ì²˜ëŸ¼ ì‘ìš©í•˜ê³  ê·¸ í‹€ ì•ˆì˜ ë‚´ìš©ì„ list.htmlì˜ contentë¶€ë¶„ìœ¼ë¡œ ì±„ìš´ë‹¤ê³  ìƒê°í•˜ë©´ ì‰½ë‹¤.<br /></h4>
</blockquote>

<p>ì ì´ì œ ì•±ì„ ì‹¤í–‰í•´ ë³´ì. http://localhost:8080/guestbook/ìœ¼ë¡œ ì ‘ì†í•˜ê±°ë‚˜ http://localhost:8080/guestbook/list ë¡œ ì ‘ì†í•´ë„ ë˜‘ê°™ì€ ë·°ê°€ ë³´ì¸ë‹¤. ì´ìœ ëŠ” ì•ì— Controllerì—ì„œ @GetMapping ì–´ë…¸í…Œì´ì…˜ ì•ˆì— â€œ/â€ ì´ê²ƒê³¼ â€œlistâ€ ë‘ ê°œë¥¼ ë„£ì–´ì¤¬ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-02-17-49-01.png" alt="" /></p>

<p><br /></p>

<p>ë°ì´í„°ë¥¼ ë“±ë¡ê³¼ ìˆ˜ì • ì‹œê°„ì´ ìë™ìœ¼ë¡œ ì¶”ê°€ë˜ê³  ë³€ê²½ë˜ì–´ì•¼ í•˜ëŠ” ì»¬ëŸ¼ë“¤ì´ ìˆëŠ”ë° ì´ë¥¼ ì¼ì¼ì´ ì²˜ë¦¬í•˜ë©´ ë²ˆê±°ë¡­ê¸° ë•Œë¬¸ì— ìë™ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´ì„œ ì„¤ì •í•˜ë©´ í¸í•˜ë‹¤. í”„ë¡œì íŠ¸ ë‚´ì— entity íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ê³  ì—”í‹°í‹° ê°ì²´ì˜ ë“±ë¡ ì‹œê°„ê³¼ ìµœì¢… ìˆ˜ì • ì‹œê°„ì„ ë‹´ë‹¹í•˜ê²Œ ë  BaseEntity í´ë˜ìŠ¤ë¥¼ ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì‘ì„±í•œë‹¤.</p>

<p><strong>BaseEntity.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.techlead.guestbook.entity</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.Getter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.annotation.CreatedDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.annotation.LastModifiedDate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.domain.support.AuditingEntityListener</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.Column</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.EntityListeners</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.MappedSuperclass</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>

<span class="nd">@MappedSuperclass</span>
<span class="nd">@EntityListeners</span><span class="o">(</span><span class="n">value</span><span class="o">={</span><span class="nc">AuditingEntityListener</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="nd">@Getter</span>
<span class="kd">abstract</span> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">BaseEntity</span> <span class="o">{</span>
    <span class="nd">@CreatedDate</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"regdate"</span><span class="o">,</span> <span class="n">updatable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">regDate</span><span class="o">;</span>

    <span class="nd">@LastModifiedDate</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"moddate"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">modDate</span><span class="o">;</span>
<span class="o">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<blockquote>
  <h4 id="line-13-mappedsuperclassë¼ëŠ”-íŠ¹ë³„í•œ-ì–´ë…¸í…Œì´ì…˜ì€-ì ìš©ëœ-í´ë˜ìŠ¤ëŠ”-í…Œì´ë¸”ë¡œ-ìƒì„±ë˜ì§€-ì•ŠëŠ”ë‹¤-ì‹¤ì œ-í…Œì´ë¸”ì€-baseentity-í´ë˜ìŠ¤ë¥¼-ìƒì†í•œ-ì—”í‹°í‹°ì˜-í´ë˜ìŠ¤ë¡œ-ë°ì´í„°ë² ì´ìŠ¤-í…Œì´ë¸”ì´-ìƒì„±ëœë‹¤"><strong>line 13:</strong> @MappedSuperclassë¼ëŠ” íŠ¹ë³„í•œ ì–´ë…¸í…Œì´ì…˜ì€ ì ìš©ëœ í´ë˜ìŠ¤ëŠ” í…Œì´ë¸”ë¡œ ìƒì„±ë˜ì§€ ì•ŠëŠ”ë‹¤. ì‹¤ì œ í…Œì´ë¸”ì€ BaseEntity í´ë˜ìŠ¤ë¥¼ ìƒì†í•œ ì—”í‹°í‹°ì˜ í´ë˜ìŠ¤ë¡œ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì´ ìƒì„±ëœë‹¤.<br /></h4>

  <h4 id="line-17-createddateëŠ”-jpaì—ì„œ-ì—”í‹°í‹°ì˜-ìƒì„±-ì‹œê°„ì„-ì²˜ë¦¬í•œë‹¤"><strong>line 17:</strong> @CreatedDateëŠ” JPAì—ì„œ ì—”í‹°í‹°ì˜ ìƒì„± ì‹œê°„ì„ ì²˜ë¦¬í•œë‹¤.<br /></h4>

  <h4 id="line-21-lastmodifieddateëŠ”-ìµœì¢…-ìˆ˜ì •-ì‹œê°„ì„-ìë™ìœ¼ë¡œ-ì²˜ë¦¬í•˜ëŠ”-ìš©ë„ë¡œ-ì‚¬ìš©í•œë‹¤"><strong>line 21:</strong> @LastModifiedDateëŠ” ìµœì¢… ìˆ˜ì • ì‹œê°„ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•œë‹¤.<br /></h4>

  <h4 id="line-18-updatablefalseë¥¼-í†µí•´ì„œ-í•´ë‹¹-ì—”í‹°í‹°-ê°ì²´ë¥¼-ë°ì´í„°ë² ì´ìŠ¤ì—-ë°˜ì˜í• -ë•Œ-regdate-ì¹¼ëŸ¼ê°’ì€-ë³€ê²½ë˜ì§€-ì•ŠëŠ”ë‹¤"><strong>line 18:</strong> updatable=falseë¥¼ í†µí•´ì„œ í•´ë‹¹ ì—”í‹°í‹° ê°ì²´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•  ë•Œ regdate ì¹¼ëŸ¼ê°’ì€ ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤.<br /></h4>
</blockquote>

<p>ì¶”ê°€ì ìœ¼ë¡œ JPAë¥¼ ì´ìš©í•˜ë©´ì„œ AuditionEntityListenerë¥¼ í™œì„±í™”ì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” í”„ë¡œì íŠ¸ì— @EnableJpaAuditing ì„¤ì •ì„ ì¶”ê°€ í•´ì•¼ í•œë‹¤.</p>

<p>**GuestbookApplication.java</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.techlead.guestbook</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.boot.SpringApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.config.EnableJpaAuditing</span><span class="o">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="nd">@EnableJpaAuditing</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GuestbookApplication</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="nc">GuestbookApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ì´ì œ ìƒˆë¡œìš´ ì—”í‹°í‹° í´ë˜ìŠ¤ì¸ Guestbookë¥¼ ì¶”ê°€í•œë‹¤. ê·¸ë¦¬ê³  ì½”ë“œë¥¼ ì¶”ê°€í•˜ì.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-12-49-08.png" alt="" /></p>

<p><br /></p>

<p><strong>Guestbook.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.techlead.guestbook.entity</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.*</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.persistence.*</span><span class="o">;</span>

<span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Builder</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Guestbook</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span><span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span><span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">gno</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="o">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1500</span><span class="o">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">50</span><span class="o">,</span><span class="n">nullable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">writer</span><span class="o">;</span>

<span class="o">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ìœ„ ì½”ë“œë¥¼ ë³´ë©´ BaseEntityë¥¼ ìƒì†í•˜ê³  ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ BaseEntityë¥¼ ìƒì†í•˜ê²Œ ë˜ë©´ Guestbook í…Œì´ë¸”ì— ìš°ë¦¬ê°€ ì„ ì–¸ í–ˆë˜ moddateì™€ regdate í•„ë“œê°€ ìƒê¸°ê²Œ ëœë‹¤. ê·¸ë¦¬ê³  ë¦¬ìŠ¤ë„ˆë¡œ ì¸í•´ì„œ ìë™ìœ¼ë¡œ ìƒì„± ë‚ ì§œì™€ ìˆ˜ì • ë‚ ì§œê°€ ì„¤ì •ëœë‹¤.</p>

<p>ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì—ˆìœ¼ë‹ˆ ì´ì œ ìƒˆë¡œìš´ íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€í•˜ê³  GuestbookRepository ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-12-52-37.png" alt="" /></p>

<p><br /></p>

<p><strong>GuestbookRepository ì¸í„°í˜ì´ìŠ¤</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.techlead.guestbook.repository</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">org.springframework.data.jpa.repository.JpaRepository</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.techlead.guestbook.entity.Guestbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">GuestbookRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">Guestbook</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;{</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>JPAì˜ ì¿¼ë¦¬ ë©”ì„œë“œì˜ ê¸°ëŠ¥ê³¼ @Queryë¥¼ í†µí•´ì„œ ë§ì€ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆì§€ë§Œ ì„ ì–¸í•  ë•Œ ê³ ì •ëœ í˜•íƒœì˜ ê°’ì„ ê°€ì§„ë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤. ê·¸ë˜ì„œ ë³µì¡í•œ ì¡°í•©ì„ ì´ìš©í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜ê°€ ë§ì€ ìƒí™©ì—ì„œëŠ” ë™ì ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ìƒì„±í•´ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤. Querydslì€ ì´ëŸ¬í•œ ìƒí™©ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì„ ì´ìš©í•˜ë©´ ì¡°ì¸, ì„œë¸Œ ì¿¼ë¦¬ ë“±ì˜ ê¸°ëŠ¥ë„ êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>Querydslì€ ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì´ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ â€˜Që„ë©”ì¸â€™ì´ë¼ëŠ” ê²ƒì„ ì´ìš©í•´ì•¼ í•œë‹¤.</p>

<p>build.gradle íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš©ì„ ì²˜ë¦¬í•œë‹¤</p>

<ul>
  <li>plugins í•­ëª©ì— querydsl ê´€ë ¨ ë¶€ë¶„ ì¶”ê°€</li>
  <li>dependencies í•­ëª©ì— í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€</li>
  <li>Gradleì—ì„œ ì‚¬ìš©í•  ì¶”ê°€ì ì¸ taskë¥¼ ì¶”ê°€</li>
</ul>

<p><br /></p>

<p><strong>build.gradle plugin ì¶”ê°€</strong>
<img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-01-51.png" alt="" /></p>

<p><br /></p>

<p><strong>build.gradle dependencies ì¶”ê°€</strong>
<img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-02-23.png" alt="" /></p>

<p><br /></p>

<p><strong>build.gralde task ìƒì„±</strong>
<img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-03-28.png" alt="" /></p>

<p><br /></p>

<p>ì´ë ‡ê²Œ ì¶”ê°€ê°€ ë‹¤ ëë‚˜ê³  build.gradle íŒŒì¼ì´ ê°±ì‹ ë˜ë©´ ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ì´ compileQuerydslì´ë¼ëŠ” ì‹¤í–‰ ê°€ëŠ¥í•œ taskê°€ ì¶”ê°€ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-05-32.png" alt="" /></p>

<p><br /></p>

<p>ì´ê²ƒì„ ì‹¤í–‰í•˜ë©´ í”„ë¡œì íŠ¸ ë‚´ build í´ë” ì•ˆì— ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ê°€ ìƒì„±ëœë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-06-26.png" alt="" /></p>

<p><br /></p>

<p>Querydslì„ ì´ìš©í•˜ê²Œ ë˜ë©´ GuestbookRepository ì¸í„°í˜ì´ìŠ¤ ì—­ì‹œ QuerydslPredicateExecutorë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¶”ê°€ë¡œ ìƒì†í•œë‹¤.</p>

<p>ì´ì œ Querydsl ìœ„ì£¼ì˜ ì˜ˆì œë¡œ ë‹¤ë¥¸ ê°œë°œ ì „ì— í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ ë³´ì. test í´ë” ë‚´ì— repository íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•˜ê³  GuestbookRepositoryTests í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•œë‹¤.</p>

<p><strong>GuestbookRepositoryTests.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">org.techlead.guestbook.repository</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.techlead.guestbook.entity.Guestbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.IntStream</span><span class="o">;</span>

<span class="nd">@SpringBootTest</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GuestbookRepositoryTests</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">GuestbookRepository</span> <span class="n">guestbookRepository</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertDummies</span><span class="o">()</span> <span class="o">{</span>

        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">300</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="o">{</span>

            <span class="nc">Guestbook</span> <span class="n">guestbook</span> <span class="o">=</span> <span class="nc">Guestbook</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">"Title...."</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="s">"Content..."</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">writer</span><span class="o">(</span><span class="s">"user"</span> <span class="o">+</span> <span class="o">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">10</span><span class="o">))</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">guestbookRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">guestbook</span><span class="o">));</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ê·¸ë¦¬ê³  í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ mysqlì— ë°ì´í„°ê°€ ì •ìƒì ìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-17-12.png" alt="" /></p>

<p><br /></p>

<p>ì—”í‹°í‹° í´ë˜ìŠ¤ëŠ” ê°€ëŠ¥í•˜ë©´ setter ê´€ë ¨ ê¸°ëŠ¥ì„ ë§Œë“¤ì§€ ì•ŠëŠ” ê²ƒì´ ê¶Œì¥ ì‚¬í•­ì´ë‹¤. í•„ìš”ì— ë”°ë¼ ìˆ˜ì • ê¸°ëŠ¥ì„ ë§Œë“¤ê¸°ë„ í•˜ì§€ë§Œ ì—”í‹°í‹° ê°ì²´ê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ì—ì„œ ë³€ê²½ë˜ë©´ JPAë¥¼ ê´€ë¦¬í•˜ëŠ” ìª½ì´ ë³µì¡í•´ì§ˆ ìš°ë ¤ê°€ ìˆê¸° ë•Œë¬´ë„¹ ê°€ëŠ¥í•˜ë©´ ìµœì†Œí•œì˜ ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë„ë¡ í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤.</p>

<p>ì˜ˆì œë¡œ ì‘ì„± ì¤‘ì¸ ë°©ëª…ë¡ì€ í˜„ì‹¤ì ìœ¼ë¡œëŠ” ìˆ˜ì • ê¸°ëŠ¥ì´ ì—†ì–´ë„ ë¬´ë°©í•˜ì§€ë§Œ ì˜ˆì œì—ì„œëŠ” ì œëª©(title)ê³¼ ë‚´ìš©(content)ì„ ìˆ˜ì •í•  ìˆ˜ ìˆë„ë¡ changeTitle(), changeContent()ì™€ ê°™ì€ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ë„ë¡ Guestbook í´ë˜ìŠ¤ë¥¼ ìˆ˜ì •í•œë‹¤.</p>

<p><strong>Guestbook.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="o">(...)</span>
<span class="nd">@Entity</span>
<span class="nd">@Getter</span>
<span class="nd">@Builder</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Guestbook</span> <span class="kd">extends</span> <span class="nc">BaseEntity</span><span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span><span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">gno</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">100</span><span class="o">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1500</span><span class="o">,</span> <span class="n">nullable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">content</span><span class="o">;</span>

    <span class="nd">@Column</span><span class="o">(</span><span class="n">length</span><span class="o">=</span><span class="mi">50</span><span class="o">,</span><span class="n">nullable</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">writer</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeTitle</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span><span class="o">=</span><span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">changeContent</span><span class="o">(</span><span class="nc">String</span> <span class="n">content</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">content</span><span class="o">=</span><span class="n">content</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<p>ë³¸ê²©ì ìœ¼ë¡œ Querydsl ì‹¤ìŠµì„ í•´ë³´ì.</p>

<ul>
  <li>â€˜ì œëª©/ë‚´ìš©/ì‘ì„±ìâ€™ì™€ ê°™ì´ ë‹¨ í•˜ë‚˜ì˜ í•­ëª©ìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê²½ìš°</li>
  <li>â€˜ì œëª©+ë‚´ìš©â€™/â€™ë‚´ìš©+ì‘ì„±ìâ€™/â€™ì œëª©+ì‘ì„±ìâ€™ì™€ ê°™ì´ 2ê°œì˜ í•­ëª©ìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê²½ìš°</li>
  <li>â€˜ì œëª©+ë‚´ìš©+ì‘ì„±ìâ€™ì™€ ê°™ì´ 3ê°œì˜ í•­ëª©ìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê²½ìš°</li>
</ul>

<p><br /></p>

<p>ë§Œì¼ Guestbook ì—”í‹°í‹° í´ë˜ìŠ¤ì— ë§ì€ ë©¤ë²„ ë³€ìˆ˜ë“¤ì´ ì„ ì–¸ë˜ì–´ ìˆì—ˆë‹¤ë©´ ì´ëŸ¬í•œ ì¡°í•©ì˜ ìˆ˜ëŠ” ì—„ì²­ ë§ì•„ì§€ê²Œ ëœë‹¤. ì´ëŸ° ìƒí™©ì„ ëŒ€ë¹„í•´ì„œ ìƒí™©ì— ë§ê²Œ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” Querydslì´ í•„ìš”í•˜ë‹¤.</p>

<p>Querydslì˜ ì‚¬ìš©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
  <li>BooleanBuilderë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>ì¡°ê±´ì— ë§ëŠ” êµ¬ë¬¸ì€ Querydslì—ì„œ ì‚¬ìš©í•˜ëŠ” Predicate íƒ€ì…ì˜ í•¨ìˆ˜ë¥¼ ìƒì„±í•œë‹¤.</li>
  <li>BooleanBuilderì— ì‘ì„±ëœ Predicateë¥¼ ì¶”ê°€í•˜ê³  ì‹¤í–‰í•œë‹¤.</li>
</ul>

<p><br /></p>

<p>ì˜ˆì œë¡œ â€˜ì œëª©(title)â€™ì— â€˜1â€™ì´ë¼ëŠ” ê¸€ìê°€ ìˆëŠ” ì—”í‹°í‹°ë“¤ì„ ê²€ìƒ‰í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>

<p><strong>GuestRepositoryTests.java</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="rouge-code"><pre><span class="o">(...)</span>
  <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">GuestbookRepository</span> <span class="n">guestbookRepository</span><span class="o">;</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insertDummies</span><span class="o">(){</span>

        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">300</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="o">{</span>

            <span class="nc">Guestbook</span> <span class="n">guestbook</span> <span class="o">=</span> <span class="nc">Guestbook</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">"Title...."</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">content</span><span class="o">(</span><span class="s">"Content..."</span> <span class="o">+</span><span class="n">i</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">writer</span><span class="o">(</span><span class="s">"user"</span> <span class="o">+</span> <span class="o">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">10</span><span class="o">))</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">guestbookRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">guestbook</span><span class="o">));</span>
        <span class="o">});</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testQuery1</span><span class="o">()</span> <span class="o">{</span>

        <span class="nc">Pageable</span> <span class="n">pageable</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">by</span><span class="o">(</span><span class="s">"gno"</span><span class="o">).</span><span class="na">descending</span><span class="o">());</span>

        <span class="nc">QGuestbook</span> <span class="n">qGuestbook</span> <span class="o">=</span> <span class="nc">QGuestbook</span><span class="o">.</span><span class="na">guestbook</span><span class="o">;</span> <span class="c1">//1</span>

        <span class="nc">String</span> <span class="n">keyword</span> <span class="o">=</span> <span class="s">"1"</span><span class="o">;</span>

        <span class="nc">BooleanBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BooleanBuilder</span><span class="o">();</span>  <span class="c1">//2</span>

        <span class="nc">BooleanExpression</span> <span class="n">expression</span> <span class="o">=</span> <span class="n">qGuestbook</span><span class="o">.</span><span class="na">title</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">keyword</span><span class="o">);</span> <span class="c1">//3</span>

        <span class="n">builder</span><span class="o">.</span><span class="na">and</span><span class="o">(</span><span class="n">expression</span><span class="o">);</span> <span class="c1">//4</span>

        <span class="nc">Page</span><span class="o">&lt;</span><span class="nc">Guestbook</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">guestbookRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">builder</span><span class="o">,</span> <span class="n">pageable</span><span class="o">);</span> <span class="c1">//5</span>

        <span class="n">result</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">guestbook</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">guestbook</span><span class="o">);</span>
        <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><br /></p>

<blockquote>
  <h4 id="line-23-ê°€ì¥-ë¨¼ì €-ë™ì ìœ¼ë¡œ-ì²˜ë¦¬í•˜ê¸°-ìœ„í•´ì„œ-që„ë©”ì¸-í´ë˜ìŠ¤ë¥¼-ì–»ì–´ì˜¨ë‹¤-që„ë©”ì¸-í´ë˜ìŠ¤ë¥¼-ì´ìš©í•˜ë©´-ì—”í‹°í‹°-í´ë˜ìŠ¤ì—-ì„ ì–¸ëœ-title-content-ê°™ì€-í•„ë“œë“¤ì„-ë³€ìˆ˜ë¡œ-í™œìš©í• -ìˆ˜-ìˆë‹¤"><strong>line 23:</strong> ê°€ì¥ ë¨¼ì € ë™ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œ Që„ë©”ì¸ í´ë˜ìŠ¤ë¥¼ ì–»ì–´ì˜¨ë‹¤. Që„ë©”ì¸ í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ë©´ ì—”í‹°í‹° í´ë˜ìŠ¤ì— ì„ ì–¸ëœ title, content ê°™ì€ í•„ë“œë“¤ì„ ë³€ìˆ˜ë¡œ í™œìš©í•  ìˆ˜ ìˆë‹¤.<br /></h4>
  <h4 id="line-27-booleanbuilderëŠ”-whereë¬¸ì—-ë“¤ì–´ê°€ëŠ”-ì¡°ê±´ë“¤ì„-ë„£ì–´ì£¼ëŠ”-ì»¨í…Œì´ë„ˆë¼ê³ -ê°„ì£¼í•œë‹¤"><strong>line 27:</strong> BooleanBuilderëŠ” whereë¬¸ì— ë“¤ì–´ê°€ëŠ” ì¡°ê±´ë“¤ì„ ë„£ì–´ì£¼ëŠ” ì»¨í…Œì´ë„ˆë¼ê³  ê°„ì£¼í•œë‹¤.<br /></h4>
  <h4 id="line-29-ì›í•˜ëŠ”-ì¡°ê±´ì€-í•„ë“œ-ê°’ê³¼-ê°™ì´-ê²°í•©í•´ì„œ-ìƒì„±í•œë‹¤-booleanbuilder-ì•ˆì—-ë“¤ì–´ê°€ëŠ”-ê°’ì€-comquerydslcoretypespredicate-íƒ€ì…ì´ì–´ì•¼-í•œë‹¤javaì—-ìˆëŠ”-predicate-íƒ€ì…ì´-ì•„ë‹ˆë¯€ë¡œ-ì£¼ì˜í•œë‹¤"><strong>line 29:</strong> ì›í•˜ëŠ” ì¡°ê±´ì€ í•„ë“œ ê°’ê³¼ ê°™ì´ ê²°í•©í•´ì„œ ìƒì„±í•œë‹¤. BooleanBuilder ì•ˆì— ë“¤ì–´ê°€ëŠ” ê°’ì€ com.querydsl.core.types.Predicate íƒ€ì…ì´ì–´ì•¼ í•œë‹¤(Javaì— ìˆëŠ” Predicate íƒ€ì…ì´ ì•„ë‹ˆë¯€ë¡œ ì£¼ì˜í•œë‹¤)<br /></h4>
  <h4 id="line-31-ë§Œë“¤ì–´ì§„-ì¡°ê±´ì€-whereë¬¸ì œ-andë‚˜-orê°™ì€-í‚¤ì›Œë“œì™€-ê²°í•©ì‹œí‚µë‹ˆë‹¤"><strong>line 31:</strong> ë§Œë“¤ì–´ì§„ ì¡°ê±´ì€ whereë¬¸ì œ andë‚˜ orê°™ì€ í‚¤ì›Œë“œì™€ ê²°í•©ì‹œí‚µë‹ˆë‹¤.<br /></h4>
  <h4 id="line-33-booleanbuilderëŠ”-guestbookrepositoryì—-ì¶”ê°€ëœ-querydslpredicateexcutor-ì¸í„°í˜ì´ìŠ¤ì˜-findallì„-ì‚¬ìš©í• -ìˆ˜-ìˆë‹¤"><strong>line 33:</strong> BooleanBuilderëŠ” GuestbookRepositoryì— ì¶”ê°€ëœ QuerydslPredicateExcutor ì¸í„°í˜ì´ìŠ¤ì˜ findAll()ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.<br /></h4>
</blockquote>

<p><br /></p>

<p>í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•œ í›„ ê²°ê³¼ëŠ” ì•„ë˜ ì‚¬ì§„ê³¼ ê°™ë‹¤.</p>

<p><img src="/images/Learning_SpringBoot_with_Web_Project/Part2/Chapter4/2021-03-03-13-58-12.png" alt="" /></p>

<p><br /></p>

<p>ì´ì œ ë‹¤ì¤‘ í•­ëª© ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³¸ë‹¤. ë³µí•© ì¡°ê±´ì€ ì—¬ëŸ¬ ì¡°ê±´ì´ ê²°í•©í•œ í˜•íƒœë¥¼ ë§í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ â€˜ì œëª©(title) í˜¹ì€ ë‚´ìš©(content)â€™ì— íŠ¹ì •í•œ í‚¤ì›Œë“œ(keyword)ê°€ ìˆê³  â€˜gnoê°€ 0ë³´ë‹¤ í¬ë‹¤â€™ì™€ ê°™ì€ ì¡°ê±´ì„ ì²˜ë¦¬í•´ ë³´ë„ë¡ í•œë‹¤.</p>

<p>ã…‹ã…‹ ë‹¤ì‹œ ê°œëª…í•˜ì ë‚˜ì˜ì´ë¡œ 
ë‚˜ì˜ ì˜ê·  ì˜ì¤€  â€˜ì˜â€™ ì‚¼ìœ„ì¼ì²´ ë§ˆì´ë„ ëœ¨ë..
íŠ¸ë¦¬í”Œ ì˜ ã„±</p>
:ET