I"^<p><br /><br />
<br /><br /></p>

<h1 id="스프링부트로-코로나-바이러스-트래커-만들기-02"><center>스프링부트로 코로나 바이러스 트래커 만들기-02</center></h1>

<p><br /><br /></p>

<p><em>이 프로젝트는 <strong>Java Brains</strong> 유투브 영상을 보며 공부한 것을 정리하기 위해서 남김을 알립니다. 영상과는 조금 다를 수 있음을 알립니다.</em></p>

<p><a href="https://www.youtube.com/watch?v=8hjNG9GZGnQ">Youtube 영상</a></p>

<hr />

<p>자 이제 본격적으로 서비스를 만들어보자.
아래 사진과 같이 services 패키지를 만들고 그 아래 CoronaVirusDataService 자바 클래스를 생성한다.</p>

<p><img src="/images/Program/post-7/2021-02-22-10-42-04.png" alt="" /></p>

<p><br /></p>

<p><strong>우리는 먼저 이전 게시물에서 보았던 Raw 데이터를 parse 해서 가져오는 것을 먼저 할 것이다.</strong></p>

<p>package io.javabrains.coronavirustracker.services;</p>

<p>import org.springframework.stereotype.Service;</p>

<p>import javax.annotation.PostConstruct;
import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;</p>

<p>@Service
public class CoronaVirusDataService {</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>private static String VIRUS_DATA_URL="https://raw.githubusercontent.com/CSSEGISandData/"
+"COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/"+
"time_series_covid19_confirmed_global.csv";

@PostConstruct
public void fetchVirusData() throws IOException, InterruptedException{

    HttpClient client=HttpClient.newHttpClient();
    HttpRequest request= HttpRequest.newBuilder()
            .uri(URI.create(VIRUS_DATA_URL))
            .build();

    HttpResponse&lt;String&gt; httpResponse=client.send(request, HttpResponse.BodyHandlers.ofString());

    System.out.println(httpResponse.body());
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p>}</p>

<blockquote>
  <h5 id="12-서비스임을-알리는-어노테이션">12: 서비스임을 알리는 어노테이션<br /><br /></h5>

  <h5 id="15-raw-데이터가-있는-url를-string-변수에-담아준다">15: Raw 데이터가 있는 URL를 String 변수에 담아준다.<br /><br /></h5>

  <h5 id="19-postconstruct-어노테이션은-어플리케이션이-시작하고-스프링이-이-서비스-객체를-생성하고-나면-이-postconstruct-어노테이션이-있는-메소드를-자동으로-실행시켜-준다">19: @PostConstruct 어노테이션은 어플리케이션이 시작하고 스프링이 이 서비스 객체를 생성하고 나면 이 @PostConstruct 어노테이션이 있는 메소드를 자동으로 실행시켜 준다.<br /><br /></h5>

  <h5 id="20-http-call를-할-메소드를-작성한다-throws-ioexception-interruptedexception은-밑에-clientsend-부분에서-send-함수를-쓰려면-exception를-받아야-하는데-그것을-catch하는-대신-throw를-한다">20: http call를 할 메소드를 작성한다. throws IOException, InterruptedException은 밑에 client.send 부분에서 send 함수를 쓰려면 exception를 받아야 하는데 그것을 catch하는 대신 throw를 한다.<br /><br /></h5>

  <h5 id="22-우리가-http-call를-하기-위해서는-httpclient를-사용한다">22: 우리가 Http Call를 하기 위해서는 HttpClient를 사용한다.<br /><br /></h5>

  <h5 id="23-빌더-패턴을-사용가능하게-해주고-위에-선언한-virus_data_url-문자열을-uri로-바꾸기-위한-작업이다">23: 빌더 패턴을 사용가능하게 해주고 위에 선언한 VIRUS_DATA_URL 문자열을 uri로 바꾸기 위한 작업이다.<br /><br /></h5>

  <h5 id="27-client를-보냄으로써-response를-받는다-첫-번째-파라미터로는-request-그리고-두-번째로는-bodyhandler를-넣는데-이는-body로-할-수-있는-몇-가지-기능들을-제공한다-여기서-http-body를-문자열로-반환해주는-것이다">27: client를 보냄으로써 response를 받는다. 첫 번째 파라미터로는 request 그리고 두 번째로는 BodyHandler를 넣는데 이는 Body로 할 수 있는 몇 가지 기능들을 제공한다. 여기서 http Body를 문자열로 반환해주는 것이다.<br /><br /></h5>

  <h5 id="29-반환-받은-문자열을-찍어내는-역할을-한다">29: 반환 받은 문자열을 찍어내는 역할을 한다.<br /><br /></h5>
</blockquote>
:ET